----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
------------------E---------------------------------------------------------------------------------
----------------SSSSSSSS---SSSQ-----------------------S----S------------xxxx------------------------
-----------------------------------------------------------------------xx---x-----------------------
---------------E------------------------------------------------------xx-----xxx--------------------
-----------------------------------------------------xxxx------------xx-------x-x-------------------
-------------S?S--------------S---->-----?S---------xx<>-x------xxxxxx--------S--xS-----------------
B--------------------------------------------------xx-[]--x----xxE--x-------------x-------xxx-------
b---xxxx-------------xxxxx------------------xxx---xx--[]---x--xx<>-XX--------------x-----xxB-x-----x
xxxxx---xxxxxxxxxxxxxx----xxxxxxxxxxxxxxxxxxx--xxxx---[]----xxx-[]-XX---------------xxxxxx-b--xxxxxx
XXXXX---XXXXXXXXXXXXXX---XXXXXXXXXXXXXXXXXXXX--XXXXXXXXXXXXXXXXXXXXXX---------------XXXXX?XXXXXXXXXX