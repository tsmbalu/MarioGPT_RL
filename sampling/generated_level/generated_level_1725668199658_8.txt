--------------------------------------------------
--------------------------------------------------
--------------------------------------------------
--------------------------------------------------
--------------------------------------E-----------
------------------------------------SSSSSSSS---SSS
--------------------------------------------------
-----------------------------------E--------------
------------xxxx----S-----------------------------
xxx--------xx<>-x----------------S?S--------------
<>-x------xx-[]--x--------------------------------
[]--x----xx--[]---x-----xxx--------------xxxxx----
[]---xxxxx---[]----xxxxxx--xxxxxxxxxxxxxxx----xxxx
XXXXXXXXXXXXXXXXXXXXXXXXX--XXXXXXXXXXXXXXX---XXXXX