----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------
-----------------------------------------------------------E----------------------------------------
Qx-------------------------------------------------------SSSSSSSS---SSSQ----------------------------
--x--------------xxxx-------------------------------------------------------------------------------
---x------------xx---x----------------------------------E-------------------------------------------
----x----------xx-----xxx-------xxxx----S---------------------------------------------------------xx
S----x-------xxx------<>-x-----xx<>-x-----------------S?S--------------S-----SS----Q--Q?QQ-------xx<
------x-----xx<>------[]--x---xx-[]--x----------------------------------------------------------xx-[
----->-x---xx-[]------[]---x-xx--[]---x-----xxx---------------xxxxx----------------------------xx--[
xx--<]--xxxx--[]-E----[]----xx-E-[]----xxxxxx--xxxxxxxxxxxxxxxx----xxxxxxxxxxxxxxxxxxxxxxxxxxxxx---[
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX--XXXXXXXXXXXXXXXX---XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX